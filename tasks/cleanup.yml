---
- name: Remove key for repository MariaDB when disabled
  rpm_key:
    state: absent
    key: https://yum.mariadb.org/RPM-GPG-KEY-MariaDB
  when: not wtd_repo_mariadb_enabled

- name: Remove repository MariaDB when disabled
  yum_repository:
    name: mariadb
    file: MariaDB
    state: absent
  register: wtd_repo_mariadb_removed

- name: Cleanup yum metadata if repository MariaDB was removed
  command: yum clean metadata
  args:
    warn: no
  when: wtd_repo_mariadb_removed.changed
